<!DOCTYPE html>

<html lang="zh">
<head>
<meta charset="utf-8"/>
<title>ç”Ÿæ—¥å¿«ä¹ æ²ˆé›¨åª Â· è¿›é˜¶ç‰ˆ</title>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<style>
    :root{
      --pink:#e91e63; --pink2:#ff80ab; --mask:rgba(0,0,0,.55);
      --gold:#ffd54f; --green:#4caf50; --deep:#111; --light:#eee;
    }
    html,body{height:100%}
    body{margin:0;padding:0;overflow:hidden;text-align:center;background:#000;
      font-family:"å¾®è½¯é›…é»‘",system-ui,-apple-system,Segoe UI,Roboto,PingFang SC;}

    .stage{position:absolute;inset:0;display:flex;flex-direction:column;
      justify-content:center;align-items:center;background:var(--mask);
      color:#fff;transition:opacity .6s ease;}
    .hidden{opacity:0;pointer-events:none}
    h1,h2{color:var(--pink2);text-shadow:0 0 10px rgba(255,128,171,.6);margin:.2rem 0}
    button{margin:10px;padding:12px 22px;border:none;border-radius:24px;
      background:linear-gradient(45deg,var(--pink),var(--pink2));color:#fff;font-size:1.05em;
      cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,.35);transition:transform .18s;}
    button:hover{transform:scale(1.05)}
    canvas#bg{position:absolute;inset:0;z-index:-1}

    /* Stage1 hearts */
    #hearts{position:relative;width:100%;height:60%}
    .heart{position:absolute;font-size:3.2em;cursor:pointer;user-select:none;
      animation:float 6s infinite ease-in-out;text-shadow:0 2px 6px rgba(0,0,0,.6)}
    @keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-18px)}100%{transform:translateY(0)}}

    /* Stage2 catch */
    #basket{position:absolute;bottom:18px;width:120px;height:56px;background:#d81b60;border-radius:16px;
      text-align:center;line-height:56px;color:#fff;font-weight:700;box-shadow:0 6px 18px rgba(0,0,0,.4)}
    .gift{position:absolute;font-size:2em;user-select:none}
    .timer-wrap{width:70vw;max-width:520px;height:10px;background:rgba(255,255,255,.18);
      border-radius:999px;overflow:hidden;box-shadow:inset 0 0 8px rgba(0,0,0,.35)}
    .timer-bar{height:100%;background:linear-gradient(90deg,#ffd54f,#ff7043);width:100%;transition:width .2s linear}
    .mobile-hint{position:absolute;bottom:76px;left:50%;transform:translateX(-50%);font-size:.95em;opacity:.85}
    .retry{display:none}

    /* Stage3 puzzle */
    #puzzle{width:306px;height:306px;display:grid;grid-template-columns:repeat(3,100px);grid-template-rows:repeat(3,100px);
      gap:2px;padding:4px;border-radius:10px;background:rgba(255,255,255,.06);box-shadow:0 6px 18px rgba(0,0,0,.4)}
    .p-piece{width:100px;height:100px;background-size:300px 300px;background-repeat:no-repeat;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.45)}
    .success-text{margin-top:14px;color:var(--gold);font-weight:700;opacity:0;transform:translateY(8px);transition:all .5s ease}
    .success-text.show{opacity:1;transform:translateY(0)}

    /* Stage4 asteroid */
    #asteroid-area{position:relative;width:90%;max-width:520px;height:520px;background:rgba(255,255,255,.06);
      border:2px solid var(--pink2);border-radius:12px;overflow:hidden;touch-action:none}
    #ship{position:absolute;font-size:2em;user-select:none}
    .asteroid{position:absolute;font-size:1.6em;user-select:none}

    /* Stage5 breakout */
    #breakout-wrap{display:flex;flex-direction:column;align-items:center;gap:8px}
    #breakout{background:rgba(255,255,255,.06);border:2px solid var(--pink2);border-radius:12px;touch-action:none}
    .badge{display:inline-block;padding:2px 8px;border-radius:999px;background:rgba(255,255,255,.12);margin-left:6px;font-size:.9em}

    /* Stage6 maze */
    #maze-wrap{display:flex;flex-direction:column;align-items:center;gap:10px}
    #maze-grid{display:grid;gap:2px;background:rgba(255,255,255,.06);padding:6px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.4)}
    .cell{width:26px;height:26px;background:#333}
    .wall{background:#111}
    .player{background:#ff4081}
    .exit{background:var(--green)}
    .dirpad{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
    .dirpad button{padding:10px 14px;border-radius:10px}

    /* Stage7 toast */
    .toast{position:absolute;top:12%;left:50%;transform:translateX(-50%);
      padding:8px 16px;border-radius:999px;background:rgba(0,0,0,.45);color:#fff;font-weight:600;backdrop-filter:blur(4px);
      opacity:0;transition:opacity .35s, transform .35s}
    .toast.show{opacity:1;transform:translate(-50%,0)}

    /* Finale */
    #final-msg{font-size:2.4em;color:var(--pink2);font-weight:800;animation:glow 2s infinite alternate}
    @keyframes glow{from{text-shadow:0 0 8px #ff80ab}to{text-shadow:0 0 26px #c2185b}}
    #final-photo{width:260px;border-radius:14px;margin-top:18px;box-shadow:0 8px 24px rgba(0,0,0,.6)}
  
.heart {
  display: inline-block;
  color: red;
  font-size: 22px;
  animation: heartbeat 1s infinite;
}

@keyframes heartbeat {
  0% { transform: scale(1); }
  25% { transform: scale(1.3); }
  50% { transform: scale(1); }
  75% { transform: scale(1.3); }
  100% { transform: scale(1); }
}
</style>
</head>
<body>
<!-- éŸ³ä¹ -->
<audio autoplay="autoplay" id="bg-music" loop="loop" muted="muted" style="display:none;">
<source src="music.mp3" type="audio/mpeg"/>
</audio>
<!-- æ˜Ÿç©ºèƒŒæ™¯ -->
<canvas id="bg"></canvas>
<!-- Stage1 æ‰¾çœŸå¿ƒ -->
<div class="stage" id="stage1">
<h1>ğŸ‚ æ²ˆé›¨åªï¼Œä»Šå¤©æ˜¯ä½ çš„å†’é™©ç”Ÿæ—¥ä¹‹æ—…ï¼</h1>
<p>ç‚¹ä¸­çœŸæ­£é‚£é¢—ã€çœŸå¿ƒã€‘æ‰èƒ½ç»§ç»­ <span class="heart">â¤ï¸</span> ï¼ˆåˆ«ç‚¹å‡å¿ƒå¿ƒå“¦ï¼‰</p>
<div id="hearts"></div>
</div>
<!-- Stage2 æ¥ç¤¼ç‰© -->
<div class="stage hidden" id="stage2">
<h2>ç¬¬äºŒå…³ï¼šæ¥ä½ 10 ä¸ªç¤¼ç‰©ï¼ ğŸï¼ˆå°å¿ƒ ğŸ’£ï¼‰</h2>
<div class="timer-wrap" style="margin:6px 0 8px;"><div class="timer-bar" id="timerBar"></div></div>
<div>å¾—åˆ†ï¼š<b id="score">0</b> / 10</div>
<div id="basket">ç¯®å­</div>
<div class="mobile-hint">ğŸ“± æç¤ºï¼šå·¦å³æ»‘åŠ¨/æ‹–åŠ¨å±å¹•ç§»åŠ¨ç¯®å­</div>
<button class="retry" id="retryCatch">é‡è¯•æœ¬å…³</button>
</div>
<!-- Stage3 æ‹¼å›¾ -->
<div class="stage hidden" id="stage3">
<h2>ç¬¬ä¸‰å…³ï¼šæ‹¼å‡ºæˆ‘ä»¬çš„åˆç…§ ğŸ§©</h2>
<div id="puzzle"></div>
<div class="success-text" id="puzzleOk">å®Œæˆå•¦ï¼å¥½æ£’ ğŸ‘</div>
</div>
<!-- Stage4 èº²é¿é™¨çŸ³ -->
<div class="stage hidden" id="stage4">
<h2>ç¬¬å››å…³ï¼šèº²é¿é™¨çŸ³ ğŸš€</h2>
<p>æ–¹å‘é”®/WASDï¼›æ‰‹æœºç‚¹å‡»å·¦/å³åŠåŒºç§»åŠ¨ï¼›åšæŒ <b>20</b> ç§’è¿‡å…³</p>
<div id="asteroid-area"><div id="ship">ğŸš€</div></div>
<div id="asteroid-hud">å‰©ä½™æ—¶é—´ï¼š<b id="ast-sec">20</b> ç§’ <span class="badge">æ’åˆ°å¤±è´¥</span></div>
<button class="retry" id="retryAst">é‡è¯•æœ¬å…³</button>
</div>
<!-- Stage5 æ‰“ç –å—ï¼ˆå¸¦é“å…·ï¼‰ -->
<div class="stage hidden" id="stage5">
<h2>ç¬¬äº”å…³ï¼šæ‰“ç –å— ğŸ§± <span class="badge">é“å…·ï¼šæ‰©æ¿ / ç¼©æ¿ / å¤šçƒ / æ…¢é€Ÿ / åŠ é€Ÿ</span></h2>
<div id="breakout-wrap">
<canvas height="360" id="breakout" width="520"></canvas>
<div>ç –å—å‰©ä½™ï¼š<b id="bo-left">0</b>ã€€ç”Ÿå‘½ï¼š<b id="bo-life">2</b></div>
<button class="retry" id="retryBo">é‡è¯•æœ¬å…³</button>
</div>
<p style="opacity:.85">é¼ æ ‡/è§¦æ§ç§»åŠ¨æŒ¡æ¿ï¼›æ¥ä½æ‰è½é“å…·è·å¾—æ•ˆæœ</p>
</div>
<!-- Stage6 è¿·å®«ï¼ˆéšæœºç”Ÿæˆï¼‰ -->
<div class="stage hidden" id="stage6">
<h2>ç¬¬å…­å…³ï¼šè¿·å®«æ¢é™© ğŸŒ€</h2>
<div id="maze-wrap">
<div id="maze-grid"></div>
<div class="dirpad">
<button data-dir="U">â¬†ï¸</button>
<div>
<button data-dir="L">â¬…ï¸</button>
<button data-dir="D">â¬‡ï¸</button>
<button data-dir="R">â¡ï¸</button>
</div>
</div>
<div>é”®ç›˜ WASD/æ–¹å‘é”® æˆ– ç‚¹å‡»æ–¹å‘æŒ‰é’®ç§»åŠ¨ï¼›èµ°åˆ° <b style="color:var(--green)">ç»¿è‰²å‡ºå£</b></div>
</div>
</div>
<!-- Stage7 æƒ…ä¾£ç­”é¢˜ -->
<div class="stage hidden" id="stage7">
<h2>ç¬¬ä¸ƒå…³ï¼šæƒ…ä¾£ç­”é¢˜ ğŸ’‘</h2>
<div id="question" style="margin:12px 0;font-size:1.2em;"></div>
<div id="answers" style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;"></div>
<div class="toast" id="toast">ç­”å¯¹å•¦ï¼ğŸ‰</div>
</div>
<!-- Stage8 å½©è›‹ -->
<div class="stage hidden" id="stage8">
<div id="final-msg">ğŸ‰ ç”Ÿæ—¥å¿«ä¹ï¼Œæ²ˆé›¨åªï¼æˆ‘çˆ±ä½  â¤ï¸</div>
<img alt="photo" id="final-photo" src="https://kkkksslls.oss-cn-beijing.aliyuncs.com/syp/20250917-142843.jpg"/>
<p style="opacity:.9">è½»ç‚¹å±å¹•å¯å†æ”¾ä¸€æ³¢çƒŸèŠ±âœ¨</p>
</div>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<script>
const bgMusic = document.getElementById("bg-music");
bgMusic.oncanplaythrough = () => console.log("âœ… èƒŒæ™¯éŸ³ä¹å·²åŠ è½½");
bgMusic.onerror = () => console.log("âŒ èƒŒæ™¯éŸ³ä¹åŠ è½½å¤±è´¥ï¼Œæ£€æŸ¥è·¯å¾„");

function unlockBgMusic() {
  bgMusic.muted = false;
  bgMusic.play().then(()=>{
    console.log("ğŸµ èƒŒæ™¯éŸ³ä¹å¼€å§‹æ’­æ”¾");
  }).catch(err=>{
    console.log("âš ï¸ æ’­æ”¾å¤±è´¥:", err);
  });
  document.removeEventListener("click", unlockBgMusic);
  document.removeEventListener("touchstart", unlockBgMusic);
}
document.addEventListener("click", unlockBgMusic);
document.addEventListener("touchstart", unlockBgMusic);
</script></body>
</html>
