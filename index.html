<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>ç”Ÿæ—¥å¿«ä¹ æ²ˆé›¨åª</title>
  <style>
    body {
      margin: 0; padding: 0;
      font-family: "å¾®è½¯é›…é»‘", sans-serif;
      background: linear-gradient(to right, #ffdde1, #ee9ca7);
      height: 100vh; display: flex;
      justify-content: center; align-items: center;
      flex-direction: column; text-align: center;
    }
    .hidden { display: none; }
    button {
      margin: 10px; padding: 10px 20px;
      border: none; border-radius: 20px;
      background: #e91e63; color: white;
      font-size: 1.2em; cursor: pointer;
    }
    button:hover { background: #c2185b; }
    .heart {
      position: absolute; font-size: 2em; cursor: pointer;
    }
    #question { font-size: 1.5em; margin: 20px; }
  </style>
</head>
<body>
  <!-- å¼€åœº -->
  <div id="stage1">
    <h1>ğŸ‚ æ²ˆé›¨åªï¼Œä»Šå¤©æ˜¯ä½ çš„ç‰¹åˆ«çš„ä¸€å¤© ğŸ‚</h1>
    <p>ç‚¹ä¸­æ­£ç¡®çš„å°å¿ƒå¿ƒæ‰èƒ½ç»§ç»­å“¦ ğŸ’–</p>
    <div id="hearts"></div>
  </div>

  <!-- ç­”é¢˜ -->
  <div id="stage2" class="hidden">
    <h2>ç¬¬äºŒå…³ï¼šç­”å¯¹é—®é¢˜æ‰æœ‰æƒŠå–œï¼</h2>
    <div id="question"></div>
    <div id="answers"></div>
  </div>

  <!-- åˆ®åˆ®å¡ -->
  <div id="stage3" class="hidden">
    <h2>åˆ®å¼€æƒŠå–œå¡ç‰‡ ğŸ</h2>
    <canvas id="scratch" width="300" height="150"></canvas>
    <div style="margin-top:20px;font-size:1.5em;color:#880e4f;font-weight:bold;">
      æ²ˆé›¨åªï¼Œæˆ‘çˆ±ä½  â¤ï¸
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  <script>
    // ========== ç¬¬ä¸€å…³ï¼šç‚¹å‡»å¿ƒ ==========
    const heartsContainer = document.getElementById("hearts");
    for (let i=0; i<10; i++) {
      let heart = document.createElement("div");
      heart.innerHTML = "ğŸ’–";
      heart.classList.add("heart");
      heart.style.left = Math.random()*80 + "%";
      heart.style.top = Math.random()*80 + "%";
      heartsContainer.appendChild(heart);

      heart.onclick = () => {
        if (i === 3) { // å‡è®¾ç¬¬4é¢—æ‰æ˜¯æ­£ç¡®çš„
          document.getElementById("stage1").classList.add("hidden");
          document.getElementById("stage2").classList.remove("hidden");
          loadQuestion();
        } else {
          alert("ä¸æ˜¯è¿™é¢—å¿ƒå“¦ï¼Œå†è¯•è¯•~");
        }
      }
    }

    // ========== ç¬¬äºŒå…³ï¼šç­”é¢˜ ==========
    const questions = [
      {q:"æˆ‘ä»¬ç¬¬ä¸€æ¬¡è§é¢æ˜¯åœ¨å“ªé‡Œï¼Ÿ", a:["å›¾ä¹¦é¦†","é£Ÿå ‚","æ“åœº"], correct:0},
      {q:"ä½ æœ€å–œæ¬¢çš„ç”œå“æ˜¯ï¼Ÿ", a:["è›‹ç³•","å†°æ·‡æ·‹","å·§å…‹åŠ›"], correct:1}
    ];
    let currentQ = 0;

    function loadQuestion() {
      const q = questions[currentQ];
      document.getElementById("question").innerText = q.q;
      const answersDiv = document.getElementById("answers");
      answersDiv.innerHTML = "";
      q.a.forEach((ans,idx)=>{
        let btn = document.createElement("button");
        btn.innerText = ans;
        btn.onclick = ()=>checkAnswer(idx);
        answersDiv.appendChild(btn);
      });
    }

    function checkAnswer(idx) {
      if (idx === questions[currentQ].correct) {
        if (currentQ < questions.length-1) {
          currentQ++;
          loadQuestion();
        } else {
          document.getElementById("stage2").classList.add("hidden");
          document.getElementById("stage3").classList.remove("hidden");
          initScratch();
        }
      } else {
        alert("ç­”é”™å•¦ï¼Œå†æƒ³æƒ³~");
      }
    }

    // ========== ç¬¬ä¸‰å…³ï¼šåˆ®åˆ®å¡ ==========
    function initScratch() {
      const canvas = document.getElementById("scratch");
      const ctx = canvas.getContext("2d");
      ctx.fillStyle = "#e91e63";
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.globalCompositeOperation="destination-out";

      let scratching=false;
      canvas.addEventListener("mousedown",()=>scratching=true);
      canvas.addEventListener("mouseup",()=>scratching=false);
      canvas.addEventListener("mousemove",e=>{
        if(!scratching)return;
        ctx.beginPath();
        ctx.arc(e.offsetX,e.offsetY,20,0,Math.PI*2);
        ctx.fill();
      });

      // æœ€ç»ˆå½©å¸¦çˆ†ç‚¸
      setTimeout(()=>{
        confetti({particleCount:300,spread:150,origin:{y:0.7}});
      },2000);
    }
  </script>
</body>
</html>
